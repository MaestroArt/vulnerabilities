<?php

namespace App\Repositories;

use App\Models\Vulnerability;
use Illuminate\Pagination\LengthAwarePaginator;

class VulnerabilityRepository
{
    const VULNERABILITIES_PER_PAGE = 8;

    public function getVulnerabilitiesList(array $columns = ['*']): LengthAwarePaginator
    {
        return Vulnerability::select($columns)
            ->with('user:id,name')
            ->latest('updated_at')
            ->paginate(self::VULNERABILITIES_PER_PAGE);
    }

    public function createVulnerability(array $data): Vulnerability
    {
        $data['user_id'] = auth()->id();

        return Vulnerability::create($data);
    }
}
